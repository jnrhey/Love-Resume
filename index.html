<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Love Resume ‚Äî Boyfriend</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&family=Dancing+Script:wght@500&display=swap" rel="stylesheet">
    <style>
        :root{
            --bg: linear-gradient(180deg,#fff7fb 0%, #fff 60%);
            --card: #ffffff;
            --accent: #ff6b95;
            --muted: #6b6b72;
            --soft: #ffeef6;
            --objective-bg: #fff0f6;
            --bar-track: #f1e6ea;
            --bar-fill-start: #ff6b95;
            --bar-fill-end: #ff9ac9;
            --exp-bg: #ffffff;
            --exp-border: #fff1f6;
            --avatar-grad-start: #ffd3e8;
            --avatar-grad-end: #ffecf5;
            --shadow: 0 8px 24px rgba(249,120,160,0.12);
        }
        /* Dark theme variables applied to body.dark */
        body.dark{
            --bg: linear-gradient(180deg,#0f1720 0%, #0b0d10 60%);
            --card: #0f1418;
            --accent: #ff7fb0;
            --muted: #9aa0a6;
            --soft: #1b1b1f;
            --objective-bg: rgba(255,255,255,0.02);
            --bar-track: #20252a;
            --bar-fill-start: #ff7fb0;
            --bar-fill-end: #ff4ea8;
            --exp-bg: #0b0f12;
            --exp-border: rgba(255,255,255,0.03);
            --avatar-grad-start: #2a2228;
            --avatar-grad-end: #1a1719;
            --shadow: 0 8px 24px rgba(0,0,0,0.6);
            color: #e9eef3;
        }
        *{box-sizing:border-box}
    body{font-family: 'Poppins', sans-serif; background:var(--bg); margin:0; padding:20px; color:inherit}
    .container{max-width:920px; margin:0 auto}
    /* Mobile-first: stack sections; become two-column at larger screens */
    .card{background:var(--card); border-radius:16px; box-shadow:var(--shadow); overflow:hidden; display:block; gap:0}

    /* mobile-first layout tweaks */
    .profile{width:100%; padding:16px 14px; background:linear-gradient(135deg,var(--soft), var(--card)); display:flex;flex-direction:row;align-items:center;gap:12px}
    .avatar{width:88px;height:88px;border-radius:50%;background:linear-gradient(135deg,var(--avatar-grad-start),var(--avatar-grad-end));display:flex;align-items:center;justify-content:center;font-size:40px;flex-shrink:0;overflow:hidden}
    .avatar img{width:100%;height:100%;object-fit:cover;display:block;border-radius:50%}
        .name{font-size:20px;font-weight:600; display:flex;align-items:center;gap:8px;flex-direction:column;align-items:flex-start}
        .dancing{font-family:'Dancing Script', cursive;color:var(--accent);font-size:20px}
        .meta{color:var(--muted);font-size:13px}
    /* simple pill badge */
    .badge{background:rgba(255,107,149,0.12);color:var(--accent);padding:6px 10px;border-radius:999px;font-weight:600;font-size:12px}

    .main{padding:16px}
        .section{margin-bottom:14px}
        .section h3{display:flex;align-items:center;gap:10px;margin:0 0 8px 0}
        .heart{color:var(--accent)}
    .objective{background:var(--objective-bg);padding:12px;border-radius:10px;color:inherit}

        .row{display:flex;gap:12px;flex-wrap:wrap}
        .skill{display:flex;flex-direction:column;gap:6px}
        .skill .label{display:flex;justify-content:space-between;font-size:13px;color:var(--muted)}
    .bar{height:10px;background:var(--bar-track);border-radius:999px;overflow:hidden}
    .bar > i{display:block;height:100%;background:linear-gradient(90deg,var(--bar-fill-start), var(--bar-fill-end));border-radius:999px}

    .experience-item{padding:10px;border-radius:10px;background:var(--exp-bg);border:1px solid var(--exp-border);margin-bottom:10px}
        .muted{color:var(--muted);font-size:13px}

    .cta{display:flex;gap:10px;margin-top:8px;flex-wrap:wrap}
    .btn{background:var(--accent);color:white;padding:8px 12px;border-radius:999px;border:none;cursor:pointer;font-weight:600;font-size:14px}
        .btn.ghost{background:transparent;color:var(--accent);border:1px solid rgba(255,107,149,0.18)}

        footer{margin-top:12px;color:var(--muted);font-size:13px;text-align:center}

        /* desktop layout */
        @media (min-width:760px){
            .card{display:flex}
            .profile{width:320px;flex-direction:column;align-items:center;padding:36px}
            .avatar{width:160px;height:160px;font-size:64px}
            .name{font-size:28px}
            .main{padding:28px}
        }

        /* Narrow phones (example: Galaxy S20 CSS width ~360-412) */
        @media (max-width:420px){
            body{padding:12px}
            .container{padding:0 6px}
            .profile{flex-direction:column;align-items:center;padding:12px;gap:8px}
            .avatar{width:72px;height:72px;font-size:34px}
            .name{font-size:18px}
            .dancing{font-size:18px}
            .meta, .muted{font-size:12px}
            .badge{font-size:11px;padding:5px 8px}
            .main{padding:12px}
            .experience-item{padding:8px}
            .bar{height:8px}
            .btn{padding:7px 10px;font-size:13px}
            footer{font-size:12px}
            .row{gap:10px}
            ul{margin-left:14px}
        }

        /* print tweaks */
        @media print{
            body{padding:0}
            .card{box-shadow:none;border-radius:0}
            .btn{display:none}
            .profile{background:transparent}
        }

        /* small helpers */
        .controls{display:flex;gap:8px;flex-wrap:wrap;align-items:center}
        .input{padding:8px;border-radius:8px;border:1px solid #eee;font-size:14px}
        .full-width{width:100%}
        /* modern/cute effects */
        :root{--glow: 0 6px 20px rgba(255,107,149,0.18)}
        body{transition:background 420ms ease,color 320ms ease}
        .card{transition:transform 320ms ease, box-shadow 320ms ease}
        .card:hover{transform:translateY(-6px)}
        .btn{transition:transform 160ms ease, box-shadow 160ms ease, opacity 160ms}
        .btn:hover{transform:translateY(-3px) scale(1.02);box-shadow:var(--glow)}
        .btn:active{transform:translateY(0) scale(0.99)}

        /* heartbeat for heart icons */
        .heart{animation:heartBeat 1.4s infinite;display:inline-block}
        @keyframes heartBeat{
            0%{transform:scale(1)}
            14%{transform:scale(1.18)}
            28%{transform:scale(1)}
            42%{transform:scale(1.12)}
            70%{transform:scale(1)}
        }

        /* floating hearts/confetti container (covers viewport) */
        .effects-layer{position:fixed;inset:0;pointer-events:none;overflow:hidden;z-index:9999}
        .spawn-heart{position:absolute;font-size:22px;will-change:transform,opacity;animation:floatUp 1400ms cubic-bezier(.2,.8,.2,1) forwards}
        @keyframes floatUp{
            0%{transform:translateY(0) scale(0.9);opacity:0}
            10%{opacity:1}
            60%{transform:translateY(-160px) translateX(var(--tx,0)) rotate(var(--r,0deg)) scale(1)}
            100%{transform:translateY(-260px) translateX(var(--tx,0)) rotate(var(--r,0deg)) scale(0.8);opacity:0}
        }
        .confetti{position:absolute;width:10px;height:10px;border-radius:50%;will-change:transform,opacity;background:var(--accent);animation:confettiFall 1200ms cubic-bezier(.2,.8,.2,1) forwards}
        @keyframes confettiFall{
            0%{transform:translateY(0) rotate(0);opacity:1}
            100%{transform:translateY(260px) translateX(var(--tx,0)) rotate(420deg);opacity:0}
        }

        /* accessibility: respect reduced motion */
        @media (prefers-reduced-motion: reduce){
            .card, .btn, .heart, .spawn-heart, .confetti {animation: none !important; transition: none !important}
        }
    </style>
</head>
<body>
    <div class="container">
        <div style="display:flex;justify-content:center;align-items:center;gap:12px;margin-bottom:12px">
            <h1 style="margin:0;font-size:20px">Love Resume</h1>
            <div style="display:flex;gap:8px;align-items:center">
                <button id="mobileEnableBtn" title="Enable mobile effects" style="background:transparent;border:1px solid rgba(0,0,0,0.06);padding:6px 10px;border-radius:999px;cursor:pointer;display:none">‚ú® Mobile</button>
                <button id="themeToggle" title="Toggle dark mode" style="background:transparent;border:1px solid rgba(0,0,0,0.06);padding:6px 10px;border-radius:999px;cursor:pointer">üåô</button>
            </div>
        </div>

        <div class="card" role="article" aria-label="Love resume for Boyfriend">
            <aside class="profile">
                    <div class="avatar" id="avatar"><img src="dp.jpg" alt="Profile photo"></div>
                <div style="display:flex;flex-direction:column;gap:8px;align-items:flex-start;width:100%">
                    <div class="name" id="displayName">Jan Rhey P. Paa√±o <span class="dancing">(Your Best)</span></div>
                    <div class="meta" id="subtitle">Official title: Chief Cuddle Officer</div>
                    <div class="muted" style="font-size:13px"><strong>For:</strong> <span id="herNameDisplay">Kristine Crisette</span></div>
                    <div class="badge">Available for hugs ¬∑ 24/7</div>
                </div>

                <div style="width:100%;margin-top:12px;display:flex;flex-direction:column;gap:8px" aria-label="Contact and quick facts">
                    <div class="muted"><strong>Location:</strong>&nbsp;<span id="locationText">Wherever you are</span></div>
                    <div class="muted"><strong>Email:</strong>&nbsp;<span id="emailText">xxxjanrheypaanoxxx@gmail.com</span></div>
                    <div class="muted"><strong>Phone:</strong>&nbsp;<span id="phoneText">09617767044</span></div>
                    <div class="muted"><strong>Age:</strong>&nbsp;<span id="ageText">23</span></div>
                    <div class="muted"><strong>Birthday:</strong>&nbsp;<span id="bdayText">December 10, 2001</span></div>
                </div>
                <div style="margin-top:auto;font-size:13px;color:var(--muted);text-align:center">Pro tip: I make a mean breakfast and even better memories.</div>
            </aside>

            <main class="main">
                <section class="section objective">
                    <h3><span class="heart">‚ù§Ô∏è</span> Objective</h3>
                    <p style="margin:0" id="objective">To be your go-to person for laughter, support, spontaneous adventures, and cozy nights in. My aim is a long-term contract of care, curiosity, and cuddles ‚Äî renewable annually with kisses.</p>
                </section>

                <section class="section">
                    <h3>Skills & Love Languages</h3>
                    <div class="row">
                        <div style="flex:1">
                            <div class="skill">
                                <div class="label"><span>Listening</span><span>100%</span></div>
                                <div class="bar"><i style="width:100%"></i></div>
                            </div>
                            <div class="skill">
                                <div class="label"><span>Surprises & Thoughtful Gestures</span><span>92%</span></div>
                                <div class="bar"><i style="width:92%"></i></div>
                            </div>
                            <div class="skill">
                                <div class="label"><span>Cooking/Comfort Food</span><span>86%</span></div>
                                <div class="bar"><i style="width:86%"></i></div>
                            </div>
                        </div>
                        <div style="width:220px">
                            <div class="muted">Primary Love Languages</div>
                            <ul style="margin:8px 0 0 16px">
                                <li>Quality Time</li>
                                <li>Physical Touch</li>
                                <li>Words of Affirmation</li>
                            </ul>
                        </div>
                    </div>
                </section>

                <section class="section">
                    <h3>Experience</h3>
                    <article class="experience-item">
                        <div style="display:flex;justify-content:space-between;align-items:baseline">
                            <div><strong>Official Boyfriend</strong> ‚Äî Partner-in-crime</div>
                            <div class="muted">Aspirational</div>
                        </div>
                        <div class="muted" style="margin-top:6px">Intentions: Learn your favorite coffee order (when we meet), plan small spontaneous adventures, and build cozy blanket forts together.</div>
                    </article>

                    <article class="experience-item">
                        <div style="display:flex;justify-content:space-between;align-items:baseline">
                            <div><strong>Support Specialist</strong> ‚Äî Shoulder & Encouragement</div>
                            <div class="muted">Ongoing</div>
                        </div>
                        <div class="muted" style="margin-top:6px">Intentions: Be here for late-night talks, cheer for your wins (big or small), and bring snacks to movie nights ‚Äî virtual or in person.</div>
                    </article>
                </section>

                <section class="section">
                    <h3>Hobbies & Interests</h3>
                    <div style="display:flex;gap:18px;flex-wrap:wrap">
                        <div style="min-width:180px">
                            <div class="muted" style="font-weight:600">Hobbies</div>
                            <ul style="margin:8px 0 0 16px">
                                <li>Basketball</li>
                                <li>Fixing stuff (handy projects)</li>
                                <li>Badminton</li>
                                <li>Playing video games</li>
                            </ul>
                        </div>
                        <div style="min-width:180px">
                            <div class="muted" style="font-weight:600">Interests</div>
                            <ul style="margin:8px 0 0 16px">
                                <li>Food</li>
                                <li>Cars</li>
                                <li>Technology</li>
                                <li>You (hehe)</li>
                            </ul>
                        </div>
                    </div>
                </section>

                <section class="section">
                    <h3>References</h3>
                    <div class="muted">Available upon request ‚Äî but you can ask your friends, family, and your Dog(Namii). They all approve.</div>
                </section>

                <div class="cta">
                    <button class="btn" onclick="pledge()">Pledge</button>
                    <button class="btn ghost" onclick="nudge()">Send a Nudge</button>
                    <button class="btn" onclick="openMessageModal()">Generate Message</button>
                </div>

                <footer>Handcrafted with <span class="heart">‚ù§Ô∏è</span> ‚Ä¢ Made by Jan Rhey P. Paa√±o ‚Ä¢ Resume ID: BF-LOVE-2025</footer>
            </main>
        </div>
    </div>

    <!-- Message modal (simple) -->
    <div id="messageBox" style="position:fixed;inset:0;display:none;align-items:center;justify-content:center;background:rgba(0,0,0,0.4);padding:20px">
        <div style="background:white;padding:18px;border-radius:12px;max-width:520px;width:100%">
            <h3 style="margin-top:0">Send a quick message</h3>
            <div style="display:flex;gap:8px;align-items:center;margin-bottom:8px;flex-wrap:wrap">
                <select id="meetupTemplate" class="input" style="min-width:160px">
                    <option value="casual">Casual (coffee / quick meet)</option>
                    <option value="romantic">Romantic (special date)</option>
                    <option value="direct">Direct (quick ask)</option>
                </select>
                <button class="btn ghost" onclick="insertMeetup()">Insert Meetup</button>
                <button class="btn" onclick="insertSuggestedTimes()">Suggest Times</button>
            </div>
            <textarea id="messageText" rows="6" class="input full-width" style="resize:vertical;margin-bottom:8px">I made this little "Love Resume" for you ‚Äî because you deserve a permanent job as my favorite person. üíñ</textarea>
            <div style="display:flex;gap:8px;justify-content:flex-end">
                <button class="btn ghost" onclick="closeMessageModal()">Close</button>
                <button class="btn" onclick="copyMessage()">Copy Message</button>
                <button class="btn" onclick="sendMessenger()">Open Messenger</button>
                <button class="btn" onclick="sendFacebook()">Share on Facebook</button>
            </div>
        </div>
    </div>
    <!-- effects layer (floating hearts/confetti) -->
    <div id="effects" class="effects-layer" aria-hidden="true"></div>

    <script>
        function applyCustomization(){
            // The top controls may have been removed. Guard against missing elements so script doesn't throw.
            const toEl = document.getElementById('toName');
            const fromEl = document.getElementById('fromName');
            const tplEl = document.getElementById('msgTemplate');
            const includeEl = document.getElementById('includeClosing');

            if(!toEl && !fromEl && !tplEl && !includeEl){
                // nothing to apply ‚Äî avoid errors and exit early
                return;
            }

            const to = toEl ? toEl.value.trim() : '';
            const from = fromEl ? fromEl.value.trim() : '';
            const tpl = tplEl ? tplEl.value : 'default';
            const includeClosing = includeEl ? includeEl.checked : true;

            if(to) document.getElementById('displayName').innerHTML = to + "'s Boyfriend <span class=\"dancing\">(Your Best)</span>";
            if(from) document.getElementById('subtitle').textContent = 'From: ' + from + ' ‚Äî Official title: Chief Cuddle Officer';

            const templates = {
                default: `Hi ${to || 'love'},\n\nI made a little Love Resume for you ‚Äî because you deserve a permanent job as my favorite person. Can't wait to make more memories with you.`,
                romantic: `My dearest ${to || 'love'},\n\nEvery day with you feels like the best chapter. I put together this little Love Resume to tell you, in a silly official way, how much you mean to me.`,
                funny: `Hey ${to || 'babe'},\n\nIf I were applying to be your permanent snack supplier and cuddle technician, this is my cover letter. Consider this my official application.`,
                short: `Hi ${to || 'love'},\n\nJust making this quick ‚Äî I love you.`
            };

            let message = templates[tpl] || templates.default;
            if(includeClosing){
                message += `\n\nLove, ${from || 'Me'} üíñ`;
            } else {
                // If closing is removed, explain briefly why the earlier message had one (for transparency)
                message += `\n\n(You can remove the closing signature if you prefer ‚Äî the "Include closing" option controls that.)`;
            }

            const msgEl = document.getElementById('messageText');
            if(msgEl) msgEl.value = message;
        }

        function pledge(){
            // visual effect + friendly message
            spawnHearts(8);
            spawnConfetti(20);
            alert('Pledge accepted ‚Äî automatic hug queued. üíå');
        }
        function nudge(){
            spawnHearts(4);
            alert('Nudge sent. Expect a silly message soon! üòä');
        }

        function openMessageModal(){
            document.getElementById('messageBox').style.display = 'flex';
        }
        function closeMessageModal(){
            document.getElementById('messageBox').style.display = 'none';
        }
        function copyMessage(){
            const txt = document.getElementById('messageText').value;
            navigator.clipboard && navigator.clipboard.writeText(txt).then(()=>{
                alert('Message copied ‚Äî paste it into your chat!');
            }, ()=>{alert('Copy failed ‚Äî select the text and copy manually.');});
        }
        function sendMessenger(){
            const message = document.getElementById('messageText').value;
            const encoded = encodeURIComponent(message);
            // Try to open Messenger app via deep link (mobile). Many browsers will block direct app opens
            const appLink = `fb-messenger://share?text=${encoded}`;
            // Fallback web links
            const webFallback = 'https://m.me/';

            // Attempt to open the app link first, then fallback to web
            let opened = false;
            try{
                // First attempt: open app link
                window.location.href = appLink;
                opened = true;
            }catch(e){
                opened = false;
            }

            // After a short delay, if the app didn't open, open the web fallback and prompt user to paste
            setTimeout(()=>{
                // Open messenger web in a new tab and remind user to paste the message
                window.open(webFallback, '_blank');
                try{
                    navigator.clipboard && navigator.clipboard.writeText(message);
                    alert('Message copied to clipboard. Paste it into Messenger.');
                }catch(e){
                    alert('Opened Messenger web. Please paste the message there.');
                }
            }, 700);
        }

        function sendFacebook(){
            const message = document.getElementById('messageText').value;
            // Facebook share dialogs require a URL; for simple text sharing we copy to clipboard and open Facebook
            try{
                navigator.clipboard && navigator.clipboard.writeText(message).then(()=>{
                    window.open('https://www.facebook.com/jnrheytv', '_blank');
                    alert('Message copied to clipboard. Paste it in a Messenger chat or Facebook post.');
                }, ()=>{
                    window.open('https://www.facebook.com/jnrheytv', '_blank');
                    alert('Opened Facebook. Copy the message manually and paste it where you want.');
                });
            }catch(e){
                window.open('https://www.facebook.com/jnrheytv', '_blank');
                alert('Opened Facebook. Copy the message manually and paste it where you want.');
            }
        }

        // default recipient name (visible on the profile)
        const herName = 'Kristine Crisette';
        document.getElementById('herNameDisplay').textContent = herName;

        // small helper for pre-filling when the page loads on mobile
        (function prefill(){
            // Only apply customization if the inputs exist (header controls may have been removed)
            if(document.getElementById('toName') || document.getElementById('fromName')){
                applyCustomization();
            }
        })();

        // Theme toggle (dark mode)
        (function themeInit(){
            const btn = document.getElementById('themeToggle');
            const saved = localStorage.getItem('lr-theme');
            const body = document.body;
            function updateIcon(){
                btn.textContent = body.classList.contains('dark') ? '‚òÄÔ∏è' : 'üåô';
                btn.title = body.classList.contains('dark') ? 'Switch to light mode' : 'Switch to dark mode';
            }
            if(saved === 'dark') body.classList.add('dark');
            updateIcon();
            btn.addEventListener('click', ()=>{
                body.classList.toggle('dark');
                const isDark = body.classList.contains('dark');
                localStorage.setItem('lr-theme', isDark ? 'dark' : 'light');
                updateIcon();
            });
        })();

        // Effects spawning
        function spawnHearts(count){
            const container = document.getElementById('effects');
            if(!container) return;
            for(let i=0;i<count;i++){
                const el = document.createElement('div');
                el.className = 'spawn-heart';
                el.textContent = ['üíñ','‚ù§Ô∏è','üíï','üíò'][Math.floor(Math.random()*4)];
                const left = Math.random()*80 + 10; // 10% - 90%
                el.style.left = left + '%';
                el.style.setProperty('--tx', (Math.random()*80-40)+'px');
                el.style.setProperty('--r', (Math.random()*60-30)+'deg');
                container.appendChild(el);
                // remove after animation
                setTimeout(()=> el.remove(), 1600);
            }
        }

        // Mobile-specific helpers
        (function mobileInit(){
            const isMobile = /Mobi|Android|iPhone|iPad/i.test(navigator.userAgent);
            const mobileBtn = document.getElementById('mobileEnableBtn');
            if(isMobile && mobileBtn){
                mobileBtn.style.display = 'inline-block';
                mobileBtn.addEventListener('click', enableMobileEffects);
            }

            // Expose share for quick use on mobile (also used by some buttons)
            window.quickShare = function(title, text){
                if(navigator.share){
                    return navigator.share({title: title, text: text}).catch(()=>{});
                }
                return Promise.reject(new Error('Web Share not supported'));
            };
        })();

        function enableMobileEffects(){
            const btn = document.getElementById('mobileEnableBtn');
            btn.textContent = 'Enabled';
            btn.disabled = true;

            // vibration helper
            function vibrate(pattern){
                if(navigator.vibrate) navigator.vibrate(pattern);
            }

            // Hook vibration to pledge and nudge
            const originalPledge = pledge;
            pledge = function(){ vibrate([30,20,30]); originalPledge(); };
            const originalNudge = nudge;
            nudge = function(){ vibrate(60); originalNudge(); };

            // Add native share button inside message modal for mobile convenience
            const box = document.getElementById('messageBox');
            if(box){
                const shareBtn = document.createElement('button');
                shareBtn.className = 'btn';
                shareBtn.textContent = 'Share (native)';
                shareBtn.style.marginLeft = '6px';
                shareBtn.addEventListener('click', ()=>{
                    const txt = document.getElementById('messageText').value;
                    quickShare('A little note for you', txt).catch(()=>{
                        alert('Native share not available. Use copy instead.');
                    });
                });
                const footer = box.querySelector('div[style*="justify-content:flex-end"]');
                if(footer) footer.appendChild(shareBtn);
            }

            // Device orientation parallax (subtle)
            if(window.DeviceOrientationEvent && typeof DeviceOrientationEvent.requestPermission === 'function'){
                // iOS 13+ requires permission
                DeviceOrientationEvent.requestPermission().then(res=>{
                    if(res === 'granted') startParallax();
                }).catch(()=>{});
            } else if(window.DeviceOrientationEvent){
                startParallax();
            }

            // Shake detection
            startShakeDetection();
        }

        function startParallax(){
            const avatar = document.querySelector('.avatar');
            if(!avatar) return;
            window.addEventListener('deviceorientation', (e)=>{
                // subtle tilt mapping
                const max = 12; // degrees to px mapping
                const tiltX = e.gamma || 0; // left-right
                const tiltY = e.beta || 0; // front-back
                const tx = Math.max(-max, Math.min(max, tiltX));
                const ty = Math.max(-max, Math.min(max, tiltY-10));
                avatar.style.transform = `translate3d(${tx/2}px,${ty/4}px,0) rotate(${tx/40}deg)`;
            }, {passive:true});
        }

        // Simple shake detection
        function startShakeDetection(){
            let last = {x:null,y:null,z:null,time:0};
            const threshold = 18; // device-dependent, tuned for phones
            function devMotion(e){
                const a = e.accelerationIncludingGravity;
                if(!a) return;
                const now = Date.now();
                if(last.x !== null){
                    const dx = Math.abs(last.x - a.x);
                    const dy = Math.abs(last.y - a.y);
                    const dz = Math.abs(last.z - a.z);
                    if((dx + dy + dz) > threshold && (now - last.time) > 600){
                        // detected a shake
                        spawnHearts(6);
                        nudge();
                        last.time = now;
                    }
                }
                last.x = a.x; last.y = a.y; last.z = a.z;
            }
            if(window.DeviceMotionEvent && typeof DeviceMotionEvent.requestPermission === 'function'){
                DeviceMotionEvent.requestPermission().then(res=>{
                    if(res === 'granted') window.addEventListener('devicemotion', devMotion, {passive:true});
                }).catch(()=>{});
            } else if(window.DeviceMotionEvent){
                window.addEventListener('devicemotion', devMotion, {passive:true});
            }
        }

        // Meetup message helpers
        function formatDateShort(d){
            try{
                return new Intl.DateTimeFormat(undefined, {weekday:'short', month:'short', day:'numeric', hour:'numeric', minute:'2-digit'}).format(d);
            }catch(e){
                return d.toLocaleString();
            }
        }

        function insertMeetup(){
            const tpl = document.getElementById('meetupTemplate')?.value || 'casual';
            let msg = '';
            if(tpl === 'casual'){
                msg = `Hey ${herName.split(' ')[0]}! I'd love to meet you in person when you're free ‚Äî maybe grab a quick coffee or a walk? What do you think?`;
            }else if(tpl === 'romantic'){
                msg = `Hi ${herName.split(' ')[0]} ‚Äî I really enjoy our conversations and would love to take you on a proper date. Are you open to meeting sometime soon?`;
            }else{
                msg = `${herName.split(' ')[0]}, would you like to meet up soon? I can come to a place that's convenient for you.`;
            }
            const area = document.getElementById('messageText');
            if(area) area.value = msg;
        }

        function insertSuggestedTimes(){
            // generate three suggested time slots: tomorrow evening, day after tomorrow afternoon, next weekend morning
            const now = new Date();
            const suggestions = [];
            const t1 = new Date(now); t1.setDate(now.getDate()+1); t1.setHours(18,30,0,0); // tomorrow 6:30pm
            const t2 = new Date(now); t2.setDate(now.getDate()+2); t2.setHours(15,0,0,0); // day after 3:00pm
            const t3 = new Date(now); // next weekend: add days until Saturday
            const day = now.getDay();
            const daysUntilSat = (6 - day + 7) % 7 || 7;
            t3.setDate(now.getDate() + daysUntilSat); t3.setHours(10,0,0,0);
            suggestions.push(formatDateShort(t1));
            suggestions.push(formatDateShort(t2));
            suggestions.push(formatDateShort(t3));

            const area = document.getElementById('messageText');
            const base = `Hi ${herName.split(' ')[0]}, I'd love to meet you in person ‚Äî here are a few times that work for me:`;
            const list = suggestions.map((s,i)=>`${i+1}. ${s}`).join('\n');
            if(area) area.value = `${base}\n\n${list}\n\nIf none of these work, tell me what suits you and I'll adjust.`;
        }

        function spawnConfetti(count){
            const container = document.getElementById('effects');
            if(!container) return;
            for(let i=0;i<count;i++){
                const el = document.createElement('div');
                el.className = 'confetti';
                const left = Math.random()*90 + 5;
                el.style.left = left + '%';
                el.style.background = ['#ff6b95','#ffd166','#6be4ff','#b29bff'][Math.floor(Math.random()*4)];
                el.style.setProperty('--tx', (Math.random()*120-60)+'px');
                container.appendChild(el);
                setTimeout(()=> el.remove(), 1400);
            }
        }
    </script>
</body>
</html>